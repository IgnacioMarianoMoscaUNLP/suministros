<article 
  class="menu-card" 
  [class.expanded]="desplegado"
  [class.selector-mode]="modoSelector"
  role="button"
  [attr.aria-expanded]="desplegado"
  tabindex="0"
  (keydown.enter)="toggleDesplegar()"
  (keydown.space)="toggleDesplegar(); $event.preventDefault()"
>
  <div class="card-header" (click)="toggleDesplegar()">
    <h2>{{ nombre }}</h2>
    <span class="toggle-icon" aria-hidden="true">{{ desplegado ? '−' : '+' }}</span>
  </div>
  <div class="card-content" (click)="$event.stopPropagation()">
    <ul class="platos-list platos-lectura" *ngIf="desplegado && !modoSelector">
      <li *ngFor="let plato of platos">{{ plato.nombre }}</li>
    </ul>

    <div class="platos-selector" *ngIf="desplegado && modoSelector">
      <div class="selector-item" *ngFor="let plato of platos">
        <div class="item-content">
          <input 
            type="checkbox" 
            [id]="'plato-' + nombre + '-' + plato.nombre"
            [checked]="obtenerCantidad(plato.nombre) > 0"
            (change)="agregarPlato(plato.nombre)"
            class="plato-checkbox"
          />
          <label [for]="'plato-' + nombre + '-' + plato.nombre" class="plato-nombre">
            {{ plato.nombre }}
          </label>
        </div>

        <div class="cantidad-controls" *ngIf="obtenerCantidad(plato.nombre) > 0">
          <button 
            class="btn-control" 
            (click)="quitarPlato(plato.nombre); $event.stopPropagation()"
            aria-label="Disminuir cantidad"
          >
            −
          </button>
          <span class="cantidad">{{ obtenerCantidad(plato.nombre) }}</span>
          <button 
            class="btn-control" 
            (click)="agregarPlato(plato.nombre); $event.stopPropagation()"
            aria-label="Aumentar cantidad"
          >
            +
          </button>
        </div>
      </div>
    </div>
  </div>
</article>
